<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Access Control — Team Game (MAC / DAC / RBAC)</title>
  <style>
    :root{
      --bg:#ffffff; --fg:#0b1021; --muted:#5b6485; --accent:#2563eb; --good:#059669; --bad:#b91c1c; --card:#f3f4f6;
    }
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--fg);}
    .container{max-width:1100px;margin:24px auto;padding:0 16px}
    h1{font-size:clamp(1.25rem,3.5vw,2rem);margin:.2em 0}
    h2{font-size:1.1rem;color:var(--muted);font-weight:600;margin:.2em 0 1em}
    .grid{display:grid;gap:16px}
    .cols{grid-template-columns: 1fr 1fr}
    @media (max-width: 900px){.cols{grid-template-columns: 1fr}}
    .card{background:var(--card);border-radius:18px;padding:16px;box-shadow:0 1px 2px rgba(0,0,0,.06)}
    label{font-weight:600}
    input, select, button, textarea{font:inherit}
    input[type="text"], select{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #d1d5db;background:#fff}
    button{border:0;border-radius:12px;padding:10px 14px;background:var(--accent);color:#fff;cursor:pointer;font-weight:700}
    button.ghost{background:#e5e7eb;color:#111827}
    button.warn{background:#f59e0b}
    button.danger{background:#ef4444}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .row > *{flex:1 1 auto}
    .team{display:flex;align-items:center;gap:10px;background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:10px}
    .team input{flex:1}
    .badge{display:inline-block;padding:.2em .6em;border-radius:999px;background:#e5e7eb;color:#111827;font-size:.75rem}
    .score{font-weight:800}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    .case{white-space:pre-wrap}
    .pill{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:.4em .8em;background:#e0e7ff;color:#1e3a8a;font-weight:700}
    .answer{font-weight:800}
    .correct{color:var(--good)}
    .incorrect{color:var(--bad)}
    .small{font-size:.9rem;color:var(--muted)}
    .divider{height:1px;background:#e5e7eb;margin:12px 0}
    details[open]{background:#eef2ff;border-radius:12px;padding:8px}
    kbd{background:#111827;color:#fff;border-radius:6px;padding:.12em .38em;font-weight:700}
  </style>
</head>
<body>
  <div class="container" role="main">
    <header class="card" aria-label="Game Header">
      <h1>Access Control — Team Game</h1>
      <h2>Identify each scenario as <strong>MAC</strong>, <strong>DAC</strong>, or <strong>RBAC</strong>. Teams submit answers each round; reveal to auto‑score.</h2>
      <div class="row">
        <div class="pill" aria-label="Round indicator"><span>Round</span> <span id="roundNo">1</span>/<span id="roundTotal">9</span></div>
        <div class="pill" aria-label="Points"><span>Points per correct</span> <span>+1</span></div>
        <div class="pill" aria-label="Bonus"><span>Bonus</span> <span id="bonusLabel">—</span></div>
      </div>
    </header>

    <div class="grid cols" aria-label="Game layout">
      <section class="card" aria-labelledby="teamsTitle">
        <h3 id="teamsTitle">Teams & Scores</h3>
        <div id="teams"></div>
        <div class="divider"></div>
        <div class="row" aria-label="Add team">
          <input id="teamName" type="text" placeholder="Team name (e.g., Falcons)" aria-label="New team name" />
          <button id="addTeamBtn" aria-label="Add team">Add Team</button>
          <button class="ghost" id="resetScoresBtn" aria-label="Reset scores">Reset Scores</button>
          <button class="danger" id="clearTeamsBtn" aria-label="Remove all teams">Remove All</button>
        </div>
      </section>

      <section class="card" aria-labelledby="roundTitle">
        <h3 id="roundTitle">Round</h3>
        <div id="caseWrap" class="case"></div>
        <div class="divider"></div>
        <div id="answerTable"></div>
        <div class="divider"></div>
        <div class="controls" role="group" aria-label="Round controls">
          <button id="prevBtn" class="ghost" aria-label="Previous round"><span>◀</span> Prev</button>
          <button id="lockBtn" aria-label="Lock answers">Lock Answers</button>
          <button id="revealBtn" class="warn" aria-label="Reveal and score">Reveal & Score</button>
          <button id="nextBtn" class="ghost" aria-label="Next round">Next <span>▶</span></button>
        </div>
        <details id="explainBox" class="small" aria-live="polite" aria-label="Explanation">
          <summary>Explanation & model rationale</summary>
          <div id="explainText"></div>
        </details>
      </section>
    </div>

    <section class="card" aria-labelledby="bonusTitle">
      <h3 id="bonusTitle">Bonus / Reflection (end of game)</h3>
      <p class="small">Use these for tie‑breakers or discussion.</p>
      <ol id="bonusList"></ol>
    </section>

    <section class="card" aria-labelledby="helpTitle">
      <h3 id="helpTitle">How to play (quick)</h3>
      <ul>
        <li><strong>Setup:</strong> Add team names. Explain MAC/DAC/RBAC in 60 seconds.</li>
        <li><strong>Per Round:</strong> Read the scenario. Each team chooses <em>MAC</em>, <em>DAC</em>, or <em>RBAC</em> in the table.</li>
        <li><strong>Lock</strong> to prevent late edits. Then click <strong>Reveal & Score</strong> to auto‑award +1 per correct.</li>
        <li><strong>Discuss:</strong> Open <em>Explanation</em> for rationale. Move to next round.</li>
      </ul>
      <p class="small">Keyboard: <kbd>←</kbd>/<kbd>→</kbd> to switch rounds • <kbd>L</kbd> to lock • <kbd>R</kbd> to reveal.</p>
    </section>
  </div>

  <script>
  // ====== Data (from the attached document) ======
  // Each case: prompt, correct model, explanation (succinct), tags
  const CASES = [
    // MAC — 3 cases
    { id:1, model:"MAC", title:"Military Data Access", prompt:`A military intelligence agency stores classified reports labeled Confidential, Secret, and Top Secret. Only personnel with matching security clearance can view the documents. Even high-ranking officers cannot grant access to others unless they also have the correct clearance.`, why:`Access is centrally enforced by data classification (clearance levels). Users cannot change permissions.`, who:"Central authority via classification", change:"No — users cannot change", basis:"Classification level" },
    { id:2, model:"MAC", title:"Healthcare Data in a Government Hospital", prompt:`A government hospital manages patient records under strict privacy laws. Doctors with the right security clearance can view medical histories. Only authorized specialists can access test results. Even administrators cannot view records unless their clearance allows it.`, why:`Restrictions are automatic based on data classification and policy; not editable by users.`, who:"System/government policy", change:"No — fixed by policy", basis:"Classification & policy" },
    { id:3, model:"MAC", title:"University Research Department", prompt:`In a research lab, classified data is stored in a restricted system. IT assigns access by security clearance. A Level 2 researcher can only access Level 2 or lower data. No one can manually modify access settings.`, why:`Centrally assigned clearance; mandatory rules; users cannot alter.`, who:"Central IT / policy", change:"No — mandatory", basis:"Clearance tiers" },
    // DAC — 3 cases
    { id:4, model:"DAC", title:"Employee File Sharing", prompt:`An engineer creates a project folder and decides who can edit or view. They can change permissions at any time.`, why:`Owner of the data decides and can grant/revoke.`, who:"Data owner", change:"Yes — owner can change", basis:"Ownership" },
    { id:5, model:"DAC", title:"University LMS Uploads", prompt:`A professor uploads notes and manually selects which students can view, can revoke access anytime, and decides TA edit rights.`, why:`Owner explicitly grants and edits access.`, who:"Professor (owner)", change:"Yes — owner changes", basis:"Ownership" },
    { id:6, model:"DAC", title:"Personal Cloud Storage", prompt:`A user shares specific photos in cloud storage, choosing who can view or edit and revoking as needed.`, why:`Owner fully controls sharing.`, who:"Individual owner", change:"Yes — owner changes", basis:"Ownership" },
    // RBAC — 3 cases
    { id:7, model:"RBAC", title:"Hospital Role-Based Access", prompt:`Permissions come from job roles: doctors view/update records; nurses view; receptionists manage appointments. No one can change their own role.`, why:`Predefined roles map to permissions.`, who:"System / admin role definitions", change:"No — users can't change role", basis:"Job role" },
    { id:8, model:"RBAC", title:"Banking System Roles", prompt:`Tellers can view balances, loan officers approve loans, managers have broader rights but cannot override security policies.`, why:`Access derives from organizational roles.`, who:"Org role matrix", change:"No — centrally set", basis:"Job role" },
    { id:9, model:"RBAC", title:"University IT Roles", prompt:`Students access course materials (no modify), professors upload/edit, admins manage settings but cannot see grades.`, why:`Permissions granted by role, not by individuals.`, who:"System role config", change:"No — fixed by roles", basis:"Job role" },
  ];

  const REFLECTION = [
    {q:"Key differences between DAC, MAC, and RBAC?", a:`DAC: owner controls & can change. MAC: central, classification, users can't change. RBAC: predefined roles grant permissions.`},
    {q:"When is MAC more suitable?", a:"High‑security/government contexts requiring strict, non‑overridable control."},
    {q:"How does RBAC simplify access management?", a:"Assigns permission sets to roles instead of individuals; consistent and scalable."},
    {q:"Example DAC risk?", a:"Owner accidentally shares sensitive files too broadly, causing a data leak."}
  ];

  // ====== State ======
  let state = {
    round: 0, // index in CASES
    teams: [] // {id, name, score, answer, locked}
  };

  // Load/save to localStorage for persistence between refreshes
  const save = () => localStorage.setItem('ac_game_state', JSON.stringify(state));
  const load = () => {
    try{ const s = JSON.parse(localStorage.getItem('ac_game_state')); if(s){ state = s; } }catch(e){}
  };
  load();

  // ====== DOM Helpers ======
  const $ = sel => document.querySelector(sel);
  const el = (t, attrs={}, children=[])=>{ const n=document.createElement(t); Object.entries(attrs).forEach(([k,v])=>{ if(k==='class') n.className=v; else if(k==='text') n.textContent=v; else n.setAttribute(k,v); }); children.forEach(c=> n.appendChild(c)); return n; };

  // ====== Team Management ======
  function renderTeams(){
    const wrap = $('#teams');
    wrap.innerHTML = '';
    state.teams.forEach((t, idx)=>{
      const row = el('div', {class:'team', role:'group', 'aria-label':`Team ${t.name}`}, [
        el('span', {class:'badge', text:`#${idx+1}`}),
        el('input', {value:t.name, 'aria-label':`Team ${idx+1} name`}),
        el('span', {class:'score', text:t.score ?? 0, 'aria-label':`Score ${t.score ?? 0}`}),
        el('button', {class:'ghost', 'aria-label':'-1 point'}, [document.createTextNode('–1')]),
        el('button', {'aria-label':'+1 point'}, [document.createTextNode('+1')]),
        el('button', {class:'danger', 'aria-label':'Remove team'}, [document.createTextNode('Remove')])
      ]);
      const [badge, nameInput, scoreEl, minusBtn, plusBtn, delBtn] = row.children;
      nameInput.addEventListener('input', ()=>{ t.name = nameInput.value; save(); renderAnswers(); });
      minusBtn.addEventListener('click', ()=>{ t.score=(t.score||0)-1; scoreEl.textContent=t.score; save(); });
      plusBtn.addEventListener('click', ()=>{ t.score=(t.score||0)+1; scoreEl.textContent=t.score; save(); });
      delBtn.addEventListener('click', ()=>{ state.teams = state.teams.filter(x=>x!==t); save(); renderTeams(); renderAnswers(); });
      wrap.appendChild(row);
    });
  }

  $('#addTeamBtn').addEventListener('click', ()=>{
    const name = $('#teamName').value.trim();
    if(!name) return alert('Enter a team name.');
    state.teams.push({id:crypto.randomUUID(), name, score:0, answer:null});
    $('#teamName').value='';
    save(); renderTeams(); renderAnswers();
  });

  $('#resetScoresBtn').addEventListener('click', ()=>{
    state.teams.forEach(t=> t.score=0); save(); renderTeams();
  });

  $('#clearTeamsBtn').addEventListener('click', ()=>{
    if(confirm('Remove all teams?')){ state.teams=[]; save(); renderTeams(); renderAnswers(); }
  });

  // ====== Rounds ======
  function renderRound(){
    $('#roundNo').textContent = state.round+1;
    $('#roundTotal').textContent = CASES.length;
    const c = CASES[state.round];
    $('#caseWrap').innerHTML = `<strong>${c.title}</strong>\n\n${c.prompt}`;
    $('#bonusLabel').textContent = state.round===CASES.length-1 ? 'Show reflection' : '—';
    renderAnswers();
    $('#explainText').innerHTML = `
      <p><strong>Model:</strong> ${c.model}</p>
      <ul>
        <li><strong>Who controls access?</strong> ${c.who}</li>
        <li><strong>Can users change permissions?</strong> ${c.change}</li>
        <li><strong>Basis:</strong> ${c.basis}</li>
        <li><strong>Why:</strong> ${c.why}</li>
      </ul>`;
  }

  function renderAnswers(){
    const table = el('div');
    if(state.teams.length===0){ table.appendChild(el('p', {class:'small', text:'Add teams to begin.'})); $('#answerTable').innerHTML=''; $('#answerTable').appendChild(table); return; }
    const header = el('div', {class:'row'}, [
      el('div', {style:'flex:2', text:'Team'}),
      el('div', {style:'flex:1', text:'Answer'}),
      el('div', {style:'flex:1', text:'Result'})
    ]);
    table.appendChild(header);

    const c = CASES[state.round];

    state.teams.forEach(t=>{
      if(!t.answers) t.answers = {};
      const ans = t.answers[c.id] ?? null;
      const row = el('div', {class:'row', style:'align-items:center'}, [
        el('div', {style:'flex:2'}, [el('strong', {text:t.name})]),
        (function(){
          const select = el('select', {'aria-label':`Answer for ${t.name}`});
          ['','MAC','DAC','RBAC'].forEach(v=>{
            const opt = el('option', {value:v, text: v ? v : 'Choose…'});
            if(ans && ans.choice===v) opt.selected = true;
            select.appendChild(opt);
          });
          select.disabled = ans && ans.locked ? true : false;
          select.addEventListener('change', ()=>{
            t.answers[c.id] = {choice: select.value, locked: ans? ans.locked: false, correct: ans? ans.correct: undefined};
            save();
          });
          return el('div', {style:'flex:1'}, [select]);
        })(),
        (function(){
          const res = el('div', {style:'flex:1'});
          if(ans && typeof ans.correct === 'boolean'){
            res.innerHTML = ans.correct ? `<span class="correct">✔ Correct</span>` : `<span class="incorrect">✘ Incorrect</span>`;
          } else {
            res.innerHTML = '<span class="small">—</span>';
          }
          return res;
        })()
      ]);
      table.appendChild(row);
    });

    $('#answerTable').innerHTML='';
    $('#answerTable').appendChild(table);
  }

  function lockAnswers(){
    const c = CASES[state.round];
    state.teams.forEach(t=>{
      if(!t.answers) t.answers = {};
      const current = t.answers[c.id] || {choice:'', locked:false};
      current.locked = true; t.answers[c.id] = current;
    });
    save(); renderAnswers();
  }

  function revealAndScore(){
    const c = CASES[state.round];
    state.teams.forEach(t=>{
      const a = t.answers?.[c.id];
      if(!a || !a.choice){ return; }
      const correct = (a.choice === c.model);
      a.correct = correct; a.locked = true;
      if(correct){ t.score = (t.score||0)+1; }
    });
    save(); renderTeams(); renderAnswers();
  }

  // ====== Navigation ======
  $('#prevBtn').addEventListener('click', ()=>{ if(state.round>0){ state.round--; save(); renderRound(); } });
  $('#nextBtn').addEventListener('click', ()=>{ if(state.round<CASES.length-1){ state.round++; save(); renderRound(); } });
  $('#lockBtn').addEventListener('click', lockAnswers);
  $('#revealBtn').addEventListener('click', revealAndScore);

  document.addEventListener('keydown', (e)=>{
    if(e.key==='ArrowLeft'){ $('#prevBtn').click(); }
    if(e.key==='ArrowRight'){ $('#nextBtn').click(); }
    if(e.key.toLowerCase()==='l'){ lockAnswers(); }
    if(e.key.toLowerCase()==='r'){ revealAndScore(); }
  });

  // ====== Bonus / Reflection ======
  function renderBonus(){
    const ol = $('#bonusList');
    REFLECTION.forEach(item=>{
      const li = el('li');
      li.appendChild(el('div', {text:item.q}));
      const det = el('details', {} , [ el('summary', {text:'Model answer'}), el('div', {class:'small', text:item.a}) ]);
      li.appendChild(det); ol.appendChild(li);
    });
  }

  // ====== Init ======
  if(state.round<0 || state.round>=CASES.length){ state.round = 0; }
  renderTeams();
  renderRound();
  renderBonus();
  </script>
</body>
</html>
